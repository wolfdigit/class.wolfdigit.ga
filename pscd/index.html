<!DOCTYPE html>
<html>
<title>Hello Strapdown</title>
<script src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
<xmp theme="readable" style="display:none;">
</xmp>
<script>
url = window.location.href;
pos = url.indexOf('?');
if (pos<0) {
  file = "";
  meUrl = url;
}
else {
  file = url.substring( pos+1 );
  meUrl = url.substring( 0, pos-1 );
}
if (file=="") file = "index.md";
document.title = file;
dir = meUrl.substring(0, meUrl.lastIndexOf("/")+1 );
$.get( file, function( data ) {
  while ( (p1=data.indexOf('[[['))>=0 && (p2=data.indexOf(']]]', p1))>=0 ) {
    data = data.substr(0, p1-1) + translateTable( data.substr(p1+3, p2-p1-3) ) + data.substr(p2+3);
  }
  $( "xmp" ).html( data );
  
  $.getScript("http://strapdownjs.com/v/0.2/strapdown.js").done(function() {
    $( "#content a" ).each(function() {
      url = $(this).attr("href");
      console.log(url);
      if ( url.match(/\.md$/) ) {
        pos = url.indexOf("//");
        if ( pos<0 ) {
          pos2 = url.lastIndexOf("/");
          if (pos2<0) {
             newUrl = meUrl + "?" + url;
          }
          else {
            newUrl = dir + url.substring(0, pos2+1) + "?" + url.substring(pos2+1);
          }
          $(this).attr("href", newUrl);
        }
      }
    });
    
    if (file=='people.md') replaceIDLinks();
  });
}, 'text');
</script>
<script>
function translateTable(code) {
  str = '\n';
  lines = code.replace(/^\n+|\n+$/gm,'').split("\n");
  for (var i=0; i<lines.length; i++) {
    cols = lines[i].split("\t");
    str += '| ' + cols.join(' | ') + ' |\n';
    if (i==0) {
      for (var j=0; j<cols.length; j++) {
        str += '|---';
      }
      str += '|\n';
    }
  }
  return str;
}
</script>
<script>
  function replaceIDLinks() {
    $('table tr td:nth-child(3)').each(function(){
      var orig = $(this).html();
      $(this).html('<a href="http://page.wolfdigit.ga/zero2solv/?account='+orig+'">'+orig+'</a>');
    });
  }
</script>
</html>
