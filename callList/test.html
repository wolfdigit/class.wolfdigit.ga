<html>
<head>
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
</head>
<body>
  <!--
  <iframe id='ifrm1' src="https://docs.google.com/spreadsheets/d/1dScK1gGfviRrR8cZD12ZQFA8bsgJr-RuAQygSqr6faA/pubhtml?widget=true&amp;headers=false"></iframe>
  <iframe src="https://docs.google.com/spreadsheets/d/1dScK1gGfviRrR8cZD12ZQFA8bsgJr-RuAQygSqr6faA/pubhtml"></iframe>
  <iframe src="https://docs.google.com/spreadsheets/d/1dScK1gGfviRrR8cZD12ZQFA8bsgJr-RuAQygSqr6faA/pub?output=csv"></iframe>-->
  <div id="msg">
  </div>
  <!--
  <script>
    $(function() {
      $('#msg').text($('#ifrm1').html());
    });
    
    
    $(function() {
      //websocket = new WebSocket("ws://docs.google.com:9000/daemon.php"); 
      websocket = new WebSocket("ws://docs.google.com:80/spreadsheets/d/1dScK1gGfviRrR8cZD12ZQFA8bsgJr-RuAQygSqr6faA/pub?output=csv"); 
      message = "GET /spreadsheets/d/1dScK1gGfviRrR8cZD12ZQFA8bsgJr-RuAQygSqr6faA/pub?output=csv HTTP/1.0\r\n\r\n";
      websocket.onopen = function(evt) { /* do stuff */ }; //on open event
      websocket.onclose = function(evt) { /* do stuff */ }; //on close event
      websocket.onmessage = function(evt) { console.log(evt); }; //on message event
      websocket.onerror = function(evt) { /* do stuff */ }; //on error event
      //websocket.send(message); //send method
      websocket.close(); //close method
    });
  </script>
-->
  <script>
    //url = 'https://docs.google.com/spreadsheets/d/1dScK1gGfviRrR8cZD12ZQFA8bsgJr-RuAQygSqr6faA/pubhtml?widget=true&amp;headers=false';
    url = 'https://docs.google.com/a/google.com/spreadsheets/d/1dScK1gGfviRrR8cZD12ZQFA8bsgJr-RuAQygSqr6faA/gviz/tq?tq=select%20*';
    action = function(a) {
      console.log(a);
    }; 
    /*
    $.ajax({
      url: url,
      dataType: 'JSONP',
      type: 'GET',
      crossDomain: true,
    }).always(action);
    */
    function createCORSRequest(method, url){
        var xhr = new XMLHttpRequest();
        if ("withCredentials" in xhr){
            xhr.open(method, url, true);
            //xhr.setRequestHeader("Origin", "null");
        } else if (typeof XDomainRequest != "undefined"){
            xhr = new XDomainRequest();
            xhr.open(method, url);
        } else {
            xhr = null;
        }
        return xhr;
    }

    var request = createCORSRequest("get", url);
    if (request){
        request.onload = function(){
            //do something with request.responseText
          action(request.responseText);
        };
        request.send();
    }
  </script>
</body>
</html>
